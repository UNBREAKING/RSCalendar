'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _extends2 = require('babel-runtime/helpers/extends');

var _extends3 = _interopRequireDefault(_extends2);

var _objectWithoutProperties2 = require('babel-runtime/helpers/objectWithoutProperties');

var _objectWithoutProperties3 = _interopRequireDefault(_objectWithoutProperties2);

var _getPrototypeOf = require('babel-runtime/core-js/object/get-prototype-of');

var _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);

var _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _createClass2 = require('babel-runtime/helpers/createClass');

var _createClass3 = _interopRequireDefault(_createClass2);

var _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');

var _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);

var _inherits2 = require('babel-runtime/helpers/inherits');

var _inherits3 = _interopRequireDefault(_inherits2);

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _reactDropzone = require('react-dropzone');

var _reactDropzone2 = _interopRequireDefault(_reactDropzone);

var _uuid = require('uuid');

var _uuid2 = _interopRequireDefault(_uuid);

var _FormElement = require('./FormElement');

var _FormElement2 = _interopRequireDefault(_FormElement);

var _Button = require('./Button');

var _Button2 = _interopRequireDefault(_Button);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var FileSelector = function (_Component) {
  (0, _inherits3.default)(FileSelector, _Component);

  function FileSelector(props) {
    (0, _classCallCheck3.default)(this, FileSelector);

    var _this = (0, _possibleConstructorReturn3.default)(this, (FileSelector.__proto__ || (0, _getPrototypeOf2.default)(FileSelector)).call(this, props));

    _this.state = {
      errorMsg: null
    };
    _this.onDrop = _this.onDrop.bind(_this);
    _this.onDropError = _this.onDropError.bind(_this);
    return _this;
  }

  (0, _createClass3.default)(FileSelector, [{
    key: 'onDrop',
    value: function onDrop(file) {
      if (this.props.isSlave) {
        this.props.onError(file[0] ? null : this.props.errorMessage);
        return;
      }
      this.setState({
        errorMsg: !file[0] ? this.props.errorMessage : null
      });
    }
  }, {
    key: 'onDropError',
    value: function onDropError(error) {
      this.setState({
        errorMsg: error
      });
    }
  }, {
    key: 'render',
    value: function render() {
      var _props = this.props,
          _props$id = _props.id,
          id = _props$id === undefined ? 'input-' + (0, _uuid2.default)() : _props$id,
          label = _props.label,
          accept = _props.accept,
          multiple = _props.multiple,
          buttonText = _props.buttonText,
          errorMessage = _props.errorMessage,
          props = (0, _objectWithoutProperties3.default)(_props, ['id', 'label', 'accept', 'multiple', 'buttonText', 'errorMessage']);


      var error = this.state.errorMsg;

      if (label || error) {
        var formElemProps = {
          id: id,
          label: label,
          error: error
        };

        return _react2.default.createElement(
          _FormElement2.default,
          formElemProps,
          _react2.default.createElement(FileSelector, (0, _extends3.default)({
            id: id,
            accept: accept,
            multiple: multiple,
            buttonText: buttonText,
            errorMessage: errorMessage,
            isSlave: true,
            onError: this.onDropError
          }, props))
        );
      }

      return _react2.default.createElement(
        'div',
        { className: 'slds-file-selector slds-file-selector--files' },
        _react2.default.createElement(
          _reactDropzone2.default,
          {
            multiple: multiple,
            accept: accept,
            onDrop: this.onDrop,
            className: 'slds-file-selector__dropzone',
            activeClassName: 'slds-has-drag-over',
            rejectClassName: 'slds-has-drag-over',
            inputProps: { className: 'slds-file-selector__input' }
          },
          _react2.default.createElement(
            'label',
            { className: 'slds-file-selector__body', htmlFor: id },
            _react2.default.createElement(
              _Button2.default,
              { className: 'slds-file-selector__button', type: 'neutral', icon: 'upload', iconAlign: 'left' },
              buttonText
            ),
            _react2.default.createElement(
              'span',
              { className: 'slds-file-selector__text slds-medium-show' },
              'or Drop Files'
            )
          )
        )
      );
    }
  }]);
  return FileSelector;
}(_react.Component);

exports.default = FileSelector;


FileSelector.propTypes = {
  id: _react.PropTypes.string,
  label: _react.PropTypes.string,
  error: _FormElement2.default.propTypes.error,
  errorMessage: _react.PropTypes.string,
  accept: _react.PropTypes.string,
  multiple: _react.PropTypes.bool,
  buttonText: _react.PropTypes.string,
  isSlave: _react.PropTypes.bool,
  onError: _react.PropTypes.func
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9zY3JpcHRzL0ZpbGVTZWxlY3Rvci5qcyJdLCJuYW1lcyI6WyJGaWxlU2VsZWN0b3IiLCJwcm9wcyIsInN0YXRlIiwiZXJyb3JNc2ciLCJvbkRyb3AiLCJiaW5kIiwib25Ecm9wRXJyb3IiLCJmaWxlIiwiaXNTbGF2ZSIsIm9uRXJyb3IiLCJlcnJvck1lc3NhZ2UiLCJzZXRTdGF0ZSIsImVycm9yIiwiaWQiLCJsYWJlbCIsImFjY2VwdCIsIm11bHRpcGxlIiwiYnV0dG9uVGV4dCIsImZvcm1FbGVtUHJvcHMiLCJjbGFzc05hbWUiLCJwcm9wVHlwZXMiLCJzdHJpbmciLCJib29sIiwiZnVuYyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7OztJQUVxQkEsWTs7O0FBRW5CLHdCQUFZQyxLQUFaLEVBQW1CO0FBQUE7O0FBQUEsa0pBQ1hBLEtBRFc7O0FBRWpCLFVBQUtDLEtBQUwsR0FBYTtBQUNYQyxnQkFBVTtBQURDLEtBQWI7QUFHQSxVQUFLQyxNQUFMLEdBQWMsTUFBS0EsTUFBTCxDQUFZQyxJQUFaLE9BQWQ7QUFDQSxVQUFLQyxXQUFMLEdBQW1CLE1BQUtBLFdBQUwsQ0FBaUJELElBQWpCLE9BQW5CO0FBTmlCO0FBT2xCOzs7OzJCQUVNRSxJLEVBQU07QUFDWCxVQUFJLEtBQUtOLEtBQUwsQ0FBV08sT0FBZixFQUF3QjtBQUN0QixhQUFLUCxLQUFMLENBQVdRLE9BQVgsQ0FBbUJGLEtBQUssQ0FBTCxJQUFVLElBQVYsR0FBaUIsS0FBS04sS0FBTCxDQUFXUyxZQUEvQztBQUNBO0FBQ0Q7QUFDRCxXQUFLQyxRQUFMLENBQWM7QUFDWlIsa0JBQVUsQ0FBQ0ksS0FBSyxDQUFMLENBQUQsR0FBVyxLQUFLTixLQUFMLENBQVdTLFlBQXRCLEdBQXFDO0FBRG5DLE9BQWQ7QUFHRDs7O2dDQUVXRSxLLEVBQU87QUFDakIsV0FBS0QsUUFBTCxDQUFjO0FBQ1pSLGtCQUFVUztBQURFLE9BQWQ7QUFHRDs7OzZCQUVRO0FBQUEsbUJBR0gsS0FBS1gsS0FIRjtBQUFBLDZCQUVMWSxFQUZLO0FBQUEsVUFFTEEsRUFGSyx3Q0FFUyxxQkFGVDtBQUFBLFVBRW1CQyxLQUZuQixVQUVtQkEsS0FGbkI7QUFBQSxVQUUwQkMsTUFGMUIsVUFFMEJBLE1BRjFCO0FBQUEsVUFFa0NDLFFBRmxDLFVBRWtDQSxRQUZsQztBQUFBLFVBRTRDQyxVQUY1QyxVQUU0Q0EsVUFGNUM7QUFBQSxVQUV3RFAsWUFGeEQsVUFFd0RBLFlBRnhEO0FBQUEsVUFFeUVULEtBRnpFOzs7QUFLUCxVQUFNVyxRQUFRLEtBQUtWLEtBQUwsQ0FBV0MsUUFBekI7O0FBRUEsVUFBSVcsU0FBU0YsS0FBYixFQUFvQjtBQUNsQixZQUFNTSxnQkFBZ0I7QUFDcEJMLGdCQURvQjtBQUVwQkMsc0JBRm9CO0FBR3BCRjtBQUhvQixTQUF0Qjs7QUFNQSxlQUNFO0FBQUE7QUFBa0JNLHVCQUFsQjtBQUNFLHdDQUFDLFlBQUQ7QUFDRSxnQkFBS0wsRUFEUDtBQUVFLG9CQUFTRSxNQUZYO0FBR0Usc0JBQVdDLFFBSGI7QUFJRSx3QkFBYUMsVUFKZjtBQUtFLDBCQUFlUCxZQUxqQjtBQU1FLHlCQU5GO0FBT0UscUJBQVUsS0FBS0o7QUFQakIsYUFRT0wsS0FSUDtBQURGLFNBREY7QUFjRDs7QUFFRCxhQUNFO0FBQUE7QUFBQSxVQUFLLFdBQVUsOENBQWY7QUFDRTtBQUFBO0FBQUE7QUFDRSxzQkFBV2UsUUFEYjtBQUVFLG9CQUFTRCxNQUZYO0FBR0Usb0JBQVEsS0FBS1gsTUFIZjtBQUlFLHVCQUFVLDhCQUpaO0FBS0UsNkJBQWdCLG9CQUxsQjtBQU1FLDZCQUFnQixvQkFObEI7QUFPRSx3QkFBYSxFQUFFZSxXQUFXLDJCQUFiO0FBUGY7QUFTRTtBQUFBO0FBQUEsY0FBTyxXQUFVLDBCQUFqQixFQUE0QyxTQUFVTixFQUF0RDtBQUNFO0FBQUE7QUFBQSxnQkFBUSxXQUFVLDRCQUFsQixFQUErQyxNQUFLLFNBQXBELEVBQThELE1BQUssUUFBbkUsRUFBNEUsV0FBVSxNQUF0RjtBQUErRkk7QUFBL0YsYUFERjtBQUVFO0FBQUE7QUFBQSxnQkFBTSxXQUFVLDJDQUFoQjtBQUFBO0FBQUE7QUFGRjtBQVRGO0FBREYsT0FERjtBQWtCRDs7Ozs7a0JBM0VrQmpCLFk7OztBQThFckJBLGFBQWFvQixTQUFiLEdBQXlCO0FBQ3ZCUCxNQUFJLGlCQUFVUSxNQURTO0FBRXZCUCxTQUFPLGlCQUFVTyxNQUZNO0FBR3ZCVCxTQUFPLHNCQUFZUSxTQUFaLENBQXNCUixLQUhOO0FBSXZCRixnQkFBYyxpQkFBVVcsTUFKRDtBQUt2Qk4sVUFBUSxpQkFBVU0sTUFMSztBQU12QkwsWUFBVSxpQkFBVU0sSUFORztBQU92QkwsY0FBWSxpQkFBVUksTUFQQztBQVF2QmIsV0FBUyxpQkFBVWMsSUFSSTtBQVN2QmIsV0FBUyxpQkFBVWM7QUFUSSxDQUF6QiIsImZpbGUiOiJGaWxlU2VsZWN0b3IuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgUHJvcFR5cGVzLCBDb21wb25lbnQgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgRHJvcHpvbmUgZnJvbSAncmVhY3QtZHJvcHpvbmUnO1xuaW1wb3J0IHV1aWQgZnJvbSAndXVpZCc7XG5pbXBvcnQgRm9ybUVsZW1lbnQgZnJvbSAnLi9Gb3JtRWxlbWVudCc7XG5pbXBvcnQgQnV0dG9uIGZyb20gJy4vQnV0dG9uJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRmlsZVNlbGVjdG9yIGV4dGVuZHMgQ29tcG9uZW50IHtcblxuICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgZXJyb3JNc2c6IG51bGwsXG4gICAgfTtcbiAgICB0aGlzLm9uRHJvcCA9IHRoaXMub25Ecm9wLmJpbmQodGhpcyk7XG4gICAgdGhpcy5vbkRyb3BFcnJvciA9IHRoaXMub25Ecm9wRXJyb3IuYmluZCh0aGlzKTtcbiAgfVxuXG4gIG9uRHJvcChmaWxlKSB7XG4gICAgaWYgKHRoaXMucHJvcHMuaXNTbGF2ZSkge1xuICAgICAgdGhpcy5wcm9wcy5vbkVycm9yKGZpbGVbMF0gPyBudWxsIDogdGhpcy5wcm9wcy5lcnJvck1lc3NhZ2UpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgIGVycm9yTXNnOiAhZmlsZVswXSA/IHRoaXMucHJvcHMuZXJyb3JNZXNzYWdlIDogbnVsbCxcbiAgICB9KTtcbiAgfVxuXG4gIG9uRHJvcEVycm9yKGVycm9yKSB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICBlcnJvck1zZzogZXJyb3IsXG4gICAgfSk7XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3Qge1xuICAgICAgaWQgPSBgaW5wdXQtJHt1dWlkKCl9YCwgbGFiZWwsIGFjY2VwdCwgbXVsdGlwbGUsIGJ1dHRvblRleHQsIGVycm9yTWVzc2FnZSwgLi4ucHJvcHNcbiAgICB9ID0gdGhpcy5wcm9wcztcblxuICAgIGNvbnN0IGVycm9yID0gdGhpcy5zdGF0ZS5lcnJvck1zZztcblxuICAgIGlmIChsYWJlbCB8fCBlcnJvcikge1xuICAgICAgY29uc3QgZm9ybUVsZW1Qcm9wcyA9IHtcbiAgICAgICAgaWQsXG4gICAgICAgIGxhYmVsLFxuICAgICAgICBlcnJvcixcbiAgICAgIH07XG5cbiAgICAgIHJldHVybiAoXG4gICAgICAgIDxGb3JtRWxlbWVudCB7IC4uLmZvcm1FbGVtUHJvcHMgfT5cbiAgICAgICAgICA8RmlsZVNlbGVjdG9yXG4gICAgICAgICAgICBpZD17IGlkIH1cbiAgICAgICAgICAgIGFjY2VwdD17IGFjY2VwdCB9XG4gICAgICAgICAgICBtdWx0aXBsZT17IG11bHRpcGxlIH1cbiAgICAgICAgICAgIGJ1dHRvblRleHQ9eyBidXR0b25UZXh0IH1cbiAgICAgICAgICAgIGVycm9yTWVzc2FnZT17IGVycm9yTWVzc2FnZSB9XG4gICAgICAgICAgICBpc1NsYXZlXG4gICAgICAgICAgICBvbkVycm9yPXsgdGhpcy5vbkRyb3BFcnJvciB9XG4gICAgICAgICAgICB7IC4uLnByb3BzIH1cbiAgICAgICAgICAvPlxuICAgICAgICA8L0Zvcm1FbGVtZW50PlxuICAgICAgKTtcbiAgICB9XG5cbiAgICByZXR1cm4gKFxuICAgICAgPGRpdiBjbGFzc05hbWU9J3NsZHMtZmlsZS1zZWxlY3RvciBzbGRzLWZpbGUtc2VsZWN0b3ItLWZpbGVzJz5cbiAgICAgICAgPERyb3B6b25lXG4gICAgICAgICAgbXVsdGlwbGU9eyBtdWx0aXBsZSB9XG4gICAgICAgICAgYWNjZXB0PXsgYWNjZXB0IH1cbiAgICAgICAgICBvbkRyb3A9e3RoaXMub25Ecm9wfVxuICAgICAgICAgIGNsYXNzTmFtZT0nc2xkcy1maWxlLXNlbGVjdG9yX19kcm9wem9uZSdcbiAgICAgICAgICBhY3RpdmVDbGFzc05hbWU9J3NsZHMtaGFzLWRyYWctb3ZlcidcbiAgICAgICAgICByZWplY3RDbGFzc05hbWU9J3NsZHMtaGFzLWRyYWctb3ZlcidcbiAgICAgICAgICBpbnB1dFByb3BzPXsgeyBjbGFzc05hbWU6ICdzbGRzLWZpbGUtc2VsZWN0b3JfX2lucHV0JyB9IH1cbiAgICAgICAgPlxuICAgICAgICAgIDxsYWJlbCBjbGFzc05hbWU9J3NsZHMtZmlsZS1zZWxlY3Rvcl9fYm9keScgaHRtbEZvcj17IGlkIH0+XG4gICAgICAgICAgICA8QnV0dG9uIGNsYXNzTmFtZT0nc2xkcy1maWxlLXNlbGVjdG9yX19idXR0b24nIHR5cGU9J25ldXRyYWwnIGljb249J3VwbG9hZCcgaWNvbkFsaWduPSdsZWZ0Jz57IGJ1dHRvblRleHQgfTwvQnV0dG9uPlxuICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPSdzbGRzLWZpbGUtc2VsZWN0b3JfX3RleHQgc2xkcy1tZWRpdW0tc2hvdyc+b3IgRHJvcCBGaWxlczwvc3Bhbj5cbiAgICAgICAgICA8L2xhYmVsPlxuICAgICAgICA8L0Ryb3B6b25lPlxuICAgICAgPC9kaXY+XG4gICAgKTtcbiAgfVxufVxuXG5GaWxlU2VsZWN0b3IucHJvcFR5cGVzID0ge1xuICBpZDogUHJvcFR5cGVzLnN0cmluZyxcbiAgbGFiZWw6IFByb3BUeXBlcy5zdHJpbmcsXG4gIGVycm9yOiBGb3JtRWxlbWVudC5wcm9wVHlwZXMuZXJyb3IsXG4gIGVycm9yTWVzc2FnZTogUHJvcFR5cGVzLnN0cmluZyxcbiAgYWNjZXB0OiBQcm9wVHlwZXMuc3RyaW5nLFxuICBtdWx0aXBsZTogUHJvcFR5cGVzLmJvb2wsXG4gIGJ1dHRvblRleHQ6IFByb3BUeXBlcy5zdHJpbmcsXG4gIGlzU2xhdmU6IFByb3BUeXBlcy5ib29sLFxuICBvbkVycm9yOiBQcm9wVHlwZXMuZnVuYyxcbn07XG4iXX0=